<ion-view left-buttons="leftButtons">
    <ion-nav-title>
      <span class="hidden-xs" translate>REGISTRY.SEARCH.TITLE</span>
      <span class="visible-xs" translate>REGISTRY.SEARCH.TITLE_SMALL_DEVICE</span>
    </ion-nav-title>

    <ion-content class="lookupForm padding no-padding-xs">

      <div class="buttons-tabs">

        <div class="pull-right">
          <div
            class="button button-tab dark"
            title="{{'REGISTRY.BTN_SHOW_WOT_HELP' | translate}}"
            ng-click="openWotLookup()">
            <i class="icon ion-person-stalker"></i>
            {{'REGISTRY.BTN_SHOW_WOT' | translate}}
          </div>
          <div
            class="button button-tab ink yellow-bg dark active"
            title="{{'REGISTRY.BTN_SHOW_PAGES_HELP' | translate}}">
            <i class="icon ion-social-buffer"></i>
            {{'REGISTRY.BTN_SHOW_PAGES' | translate}}
          </div>
        </div>
      </div>

      <form ng-submit="doSearch()"/>
        <label class="item item-input">
            <i class="icon ion-search placeholder-icon"></i>
            <input type="text"
                   placeholder="{{'REGISTRY.SEARCH.SEARCH_HELP'|translate}}"
                   ng-model="search.text"
                   ng-model-options="{ debounce: 350 }"
                   ng-change="doSearch()">
        </label>

        <!-- options -->
        <ng-include src="'plugins/es/templates/registry/lookup_options.html'"></ng-include>
      </form>

      <div class="padding-xs" style="display: block; height: 60px;">
        <div class="pull-left">
          <h4
            ng-if="!search.loading && search.lastRecords && search.results.length" translate>
            REGISTRY.SEARCH.LAST_RECORDS
          </h4>
          <h4
            ng-if="!search.loading && !search.lastRecords && (search.text.length || search.advanced != null)" translate>
            COMMON.RESULTS_LIST
          </h4>
        </div>
      </div>

      <div class="center" ng-if="search.loading">
        <ion-spinner icon="android"></ion-spinner>
      </div>

      <div class="padding assertive" ng-if="!search.loading && search.results.length===0 && search.advanced != null" translate>
        COMMON.SEARCH_NO_RESULT
      </div>

      <ion-list class="{{::motion.ionListClass}}"
           ng-if="!search.loading && search.results && search.results.length > 0">

        <ion-item ng-repeat="rec in search.results"
           class="item item-avatar item-text-wrap item-icon-right ink"
           ui-sref="app.view_page({id: rec.id, title: rec.urlTitle})">

          <i class="item-image icon cion-page-{{::rec.type}}" ng-if="!rec.avatar"></i>
          <i class="item-image avatar" style="background-image: url({{::rec.avatar.src}})" ng-if="rec.avatar"></i>
          <h2 ng-bind-html="rec.title"></h2>
          <h4 class="gray">
            <span ng-if="rec.city">
              <i class="ion-location"></i>
              <span ng-bind-html="rec.city"></span>
              |
            </span>
            <span class="item-text-wrap" ng-show="rec.description" ng-bind-html="rec.description">
            </span>
          </h4>
          <i class="icon ion-ios-arrow-right "></i>
        </ion-item>
      </ion-list>

      <ion-infinite-scroll
        ng-if="!search.loading && search.hasMore"
        spinner="android"
        on-infinite="showMore()"
        distance="1%">
      </ion-infinite-scroll>
    </ion-content>

    <button id="fab-add-registry-record"
            class="button button-fab button-fab-bottom-right button-assertive icon ion-plus hidden-md hidden-lg spin"
            ng-click="showNewPageModal()">
    </button>
</ion-view>
